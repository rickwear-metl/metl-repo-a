{"job":{"components":{"842":{"id":842,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":912,"y":32,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SQL Script 0"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"drop table ${regschema}.`generateSequencesDL${number}`"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[858]},"843":{"id":843,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":1025742816,"x":912,"y":0,"width":32,"height":16,"inputConnectorIDs":[899],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Loop Iterator 0"}}}},"visible":true},"2":{"slot":2,"name":"Variable to Iterate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"number"}}}},"visible":true},"3":{"slot":3,"name":"Starting Value","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"1"}}}},"visible":true},"4":{"slot":4,"name":"Increment Value","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"1"}}}},"visible":true},"5":{"slot":5,"name":"End Value","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"4"}}}},"visible":true},"6":{"slot":6,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false},"7":{"slot":7,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Concurrent"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[858],"inputIterationConnectorIDs":[]},"844":{"id":844,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":0,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[853,854,855,857],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"845":{"id":845,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1611478312,"x":240,"y":0,"width":32,"height":32,"inputConnectorIDs":[853],"outputSuccessConnectorIDs":[851],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"generateSequencesDL1"}}}},"visible":true},"2":{"slot":2,"name":"Create Method","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"4":{"slot":4,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"generateSequencesDL1"}}}},"visible":true},"5":{"slot":5,"name":"Table Metadata","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"column1"},"2":{"slot":2,"type":"STRING","value":"INTEGER"},"3":{"slot":3,"type":"STRING","value":"10"},"4":{"slot":4,"type":"STRING","value":""}}}},"visible":true},"6":{"slot":6,"name":"Table Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Managed"}}}},"visible":true},"7":{"slot":7,"name":"Using","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Delta"}}}},"visible":false},"8":{"slot":8,"name":"Location","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://<bucket>/<path>"}}}},"visible":false},"9":{"slot":9,"name":"Partition Keys","elements":{},"visible":true},"10":{"slot":10,"name":"Table Properties","elements":{},"visible":true},"11":{"slot":11,"name":"Comment","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"846":{"id":846,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":640,"y":0,"width":32,"height":32,"inputConnectorIDs":[856],"outputSuccessConnectorIDs":[897],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"generate sequence"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"generate sequence"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"847":{"id":847,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1611478312,"x":240,"y":64,"width":32,"height":32,"inputConnectorIDs":[857],"outputSuccessConnectorIDs":[852],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"generateSequencesDL2"}}}},"visible":true},"2":{"slot":2,"name":"Create Method","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"4":{"slot":4,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"generateSequencesDL2"}}}},"visible":true},"5":{"slot":5,"name":"Table Metadata","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"column2"},"2":{"slot":2,"type":"STRING","value":"INTEGER"},"3":{"slot":3,"type":"STRING","value":"10"},"4":{"slot":4,"type":"STRING","value":""}}}},"visible":true},"6":{"slot":6,"name":"Table Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Managed"}}}},"visible":true},"7":{"slot":7,"name":"Using","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Delta"}}}},"visible":false},"8":{"slot":8,"name":"Location","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://<bucket>/<path>"}}}},"visible":false},"9":{"slot":9,"name":"Partition Keys","elements":{},"visible":true},"10":{"slot":10,"name":"Table Properties","elements":{},"visible":true},"11":{"slot":11,"name":"Comment","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"848":{"id":848,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1611478312,"x":240,"y":144,"width":32,"height":32,"inputConnectorIDs":[854],"outputSuccessConnectorIDs":[898],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"generateSequencesDL3"}}}},"visible":true},"2":{"slot":2,"name":"Create Method","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"4":{"slot":4,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"generateSequencesDL3"}}}},"visible":true},"5":{"slot":5,"name":"Table Metadata","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"column3"},"2":{"slot":2,"type":"STRING","value":"INTEGER"},"3":{"slot":3,"type":"STRING","value":"10"},"4":{"slot":4,"type":"STRING","value":""}}}},"visible":true},"6":{"slot":6,"name":"Table Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Managed"}}}},"visible":true},"7":{"slot":7,"name":"Using","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Delta"}}}},"visible":false},"8":{"slot":8,"name":"Location","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://<bucket>/<path>"}}}},"visible":false},"9":{"slot":9,"name":"Partition Keys","elements":{},"visible":true},"10":{"slot":10,"name":"Table Properties","elements":{},"visible":true},"11":{"slot":11,"name":"Comment","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"849":{"id":849,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1611478312,"x":240,"y":240,"width":32,"height":32,"inputConnectorIDs":[855],"outputSuccessConnectorIDs":[900],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"generateSequencesDL4"}}}},"visible":true},"2":{"slot":2,"name":"Create Method","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"4":{"slot":4,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"generateSequencesDL4"}}}},"visible":true},"5":{"slot":5,"name":"Table Metadata","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"column4"},"2":{"slot":2,"type":"STRING","value":"INTEGER"},"3":{"slot":3,"type":"STRING","value":"10"},"4":{"slot":4,"type":"STRING","value":""}}}},"visible":true},"6":{"slot":6,"name":"Table Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Managed"}}}},"visible":true},"7":{"slot":7,"name":"Using","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Delta"}}}},"visible":false},"8":{"slot":8,"name":"Location","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://<bucket>/<path>"}}}},"visible":false},"9":{"slot":9,"name":"Partition Keys","elements":{},"visible":true},"10":{"slot":10,"name":"Table Properties","elements":{},"visible":true},"11":{"slot":11,"name":"Comment","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"850":{"id":850,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":235671163,"x":480,"y":0,"width":32,"height":32,"inputConnectorIDs":[851,852,898,900],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[856],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"896":{"id":896,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186829,"x":784,"y":0,"width":32,"height":32,"inputConnectorIDs":[897],"outputSuccessConnectorIDs":[899],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python Script 0"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\n\n###\n# Note: Python scripts within this component are executed by the underlying virtual machine hosting Matillion ETL\n# and utilise the memory and compute of this VM, this component is not designed for large scale data processing\n# scripts involving PySpark or other such compute-intensive packages\n###\nrcs = []\n\n\n#rowcount table1\ncursor1 = context.cursor()\ncursor1.execute('select count(*) FROM ' + regschema + '.`generateSequencesDL1`')\nrowcount1 = cursor1.fetchone()[0]\nrcs.append(rowcount1)\nif rowcount1 != 1 :\n  print \"rowcount1 is not as expected\"+ \" \" + str(rowcount1)\nelse:\n   print rowcount1\n    \n#rowcount table2\ncursor2 = context.cursor()\ncursor2.execute('select count(*) from ' + regschema + '.`generateSequencesDL2`')\nrowcount2 = cursor2.fetchone()[0]\nrcs.append(rowcount2)\nif rowcount2 != 2 :\n  print \"rowcount2 is not as expected\" + \" \" + str(rowcount2)\nelse:\n   print rowcount2\n\n#rowcount table3\ncursor3 = context.cursor()\ncursor3.execute('select count(*) from ' + regschema + '.`generateSequencesDL3`')\nrowcount3 = cursor3.fetchone()[0]\nrcs.append(rowcount3)\nif rowcount3 != 7 :\n  print \"rowcount3 is not as expected\" + \" \" + str(rowcount3)\nelse:\n   print rowcount3\n\n#rowcount table4\ncursor4 = context.cursor()\ncursor4.execute('select count(*) from ' + regschema + '.`generateSequencesDL4`')\nrowcount4 = cursor4.fetchone()[0]\nrcs.append(rowcount4)\nif rowcount4 != 3 :\n  print \"rowcount4 is not as expected\" + \" \" + str(rowcount4)\nelse:\n   print rowcount4\n    \nvalues = str(rcs).replace(\"L\", \"\")\nprint values\n\nif values == \"[1, 2, 7, 3]\" :\n  print \"All tests passed\"\nelse :\n  quit(1)"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false},"5":{"slot":5,"name":"User","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"851":{"id":851,"sourceID":845,"targetID":850},"852":{"id":852,"sourceID":847,"targetID":850},"897":{"id":897,"sourceID":846,"targetID":896},"898":{"id":898,"sourceID":848,"targetID":850},"899":{"id":899,"sourceID":896,"targetID":843},"900":{"id":900,"sourceID":849,"targetID":850}},"failureConnectors":{},"unconditionalConnectors":{"853":{"id":853,"sourceID":844,"targetID":845},"854":{"id":854,"sourceID":844,"targetID":848},"855":{"id":855,"sourceID":844,"targetID":849},"856":{"id":856,"sourceID":850,"targetID":846},"857":{"id":857,"sourceID":844,"targetID":847}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{"858":{"id":858,"sourceID":843,"targetID":842}},"noteConnectors":{},"notes":{"841":{"id":841,"x":0,"y":-157,"width":250,"height":58,"text":"Compare with acceptance test coverage","colour":"f9c21b"}},"variables":{"number":{"definition":{"name":"number","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":""}},"grids":{}},"info":{"name":"generate sequence - createTable","description":"","type":"ORCHESTRATION","tag":"ed433da7-a9ef-45de-9d63-892e5dbe8d76"}}